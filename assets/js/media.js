$(function(){function e(e){$("#upload-container").toggle(),$(".dz-preview").remove()}function a(e){e.preventDefault(),$(this).toggleClass("selected")}function t(e){$(".media-lib-grid").removeClass("focus"),$(this).addClass("focus")}function i(){$("#upload-container").hide(),$(".dz-preview").remove(),$(".media-lib-action").toggle(),$(".media-lib-select").toggle(),$(".media-lib-container").toggleClass("bulk-select"),$(".media-lib-container").hasClass("bulk-select")?$(".media-lib-grid").removeAttr("data-toggle").removeClass("normal").removeClass("focus").addClass("bulk"):$(".media-lib-grid").attr("data-toggle","modal").addClass("normal").removeClass("selected bulk")}function d(e){var a=$(".media-lib-grid:first").clone(!0);return a.find("img").attr("src",e),a.removeAttr("style"),a}function l(e){var a=$(".media-lib-grid").length;$.get(site+"/media/loadMore?start="+a,function(e){$("#load-more").attr("disabled","disabled"),$("#load-more").html("Loading..."),$.each(e.image,function(e,a){var t=d(a.src);t.attr("data-id",a.id),t.attr("data-file",a.file),t.attr("data-name",a.name),t.attr("data-date",a.uploaded_at),t.attr("data-user",a.username),t.attr("data-ext",a.ext),t.insertBefore("#load-more")}),$(".media-lib-grid").length==e.count&&$("#load-more").hide()}).done(function(){$("#load-more").removeAttr("disabled"),$("#load-more").html("Load more")})}function r(e){e.preventDefault();var a=$("#media-input-id").val();$.ajax({url:$(this).attr("action"),type:"POST",data:$(this).serialize()}).done(function(e){e&&($("#modal-id").modal("hide"),$('.media-lib-grid[data-id="'+a+'"]').remove(),s())})}function o(e){var a=[],t="";$(".media-lib-grid.selected").each(function(e,i){var d=$(this).data("id");a.push({id:d,name:$(this).data("name"),ext:$(this).data("ext")}),0!==e&&(t+=", "),t+='.media-lib-grid[data-id="'+d+'"]'});var i=JSON.stringify(a);$.ajax({url:site+"/media/multiDelete",type:"POST",data:{multi:i}}).done(function(e){e&&($(t).remove(),s())})}function s(){if("undefined"==typeof $(".media-lib-grid")[0]){var e='<h2 class="title-none text-center">There is no files uploaded.</h2>',a='<a data-toggle="modal" href="#modal-id" data-id="" data-file="" data-name="" data-date="" data-user="" class="media-lib-grid normal" style="display: none;"><img src="" alt="Image"><div class="selected-check"><i class="fa fa-check-circle"></i></div></a>';$(e).insertBefore("#load-more"),$(a).insertBefore("#load-more")}}$("#show-upload, #upload-close").click(e),$("#bulk-select").click(i),$("#cancel-select").click(i),$(".media-lib-container").on("click",".bulk",a).on("click",".normal",t),$("#load-more").click(l),$("#search-media").keyup(function(e){d("none"),$("#load-more").clone(!0);$(".media-lib-container").html("<h2>Loading..</h2>")}),$("#upload-zone").dropzone({url:$(this).attr("action"),maxFiles:20,maxFilesize:2,acceptedFiles:"image/*",createImageThumbnails:!1,processing:function(){$("#progress").parent().show()},uploadprogress:function(e,a,t){$("#progress").css("width",a+"%")},success:function(e,a){var t=d(base+"assets/uploads/image/"+a.thumbnail);t.attr("data-id",a.id),t.attr("data-file",a.data.file),t.attr("data-name",a.data.name),t.attr("data-date",a.data.uploaded_at),t.attr("data-user",a.username),t.attr("data-ext",a.data.ext),t.insertBefore(".media-lib-grid:first"),$(".title-none").remove(),$("#progress").parent().hide()}}),$(".media-lib-grid").click(function(e){var a=$(this).data("id"),t=base+$(this).data("file"),i=$(this).data("name"),d=$(this).data("date"),l=$(this).data("user"),r=$(this).data("ext");$(".media-lib-image").attr("src",t),$(".media-lib-url").attr("value",t),$(".media-lib-name").html(i),$(".media-lib-date").html(d),$(".media-lib-user").html(l),$("#media-input-id").val(a),$("#media-input-name").val(i),$("#media-input-ext").val(r)}),$("#form-delete").submit(r),$("#delete-select").click(o),$("#all-select").click(function(e){$(".media-lib-grid").toggleClass("selected")})});